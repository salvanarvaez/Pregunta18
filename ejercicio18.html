<style>body {background: white}</style><?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Untitled</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="CoolUtils HTML exporter" />
<style type="text/css">
<!--
body { color: #000000; background-color: #FFFFFF; }
.python1-classname { color: #000080; font-weight: bold; }
.python1-comment { color: #808080; font-style: italic; }
.python1-commentedcode { color: #C0C0C0; font-style: italic; }
.python1-documentation { color: #CC00FF; }
.python1-float { color: #008080; }
.python1-functionname { color: #008080; font-weight: bold; }
.python1-hexadecimal { color: #008080; }
.python1-identifier { color: #000000; }
.python1-matchingbrace { color: #0000FF; font-weight: bold; }
.python1-multi-linestring { color: #808000; }
.python1-nonreservedkeyword { color: #000080; }
.python1-number { color: #008080; }
.python1-octal { color: #008080; }
.python1-reservedword { font-weight: bold; }
.python1-space { color: #C0C0C0; }
.python1-string { color: #808000; }
.python1-symbol { color: #800000; }
.python1-syntaxerror { color: #FF0000; }
.python1-systemfunctionsandvariables { font-weight: bold; }
.python1-unbalancedbrace { color: #FFFF00; }
-->
</style>
</head>
<body>
<!--StartFragment--><pre><code><span class="python1-comment"># -*- coding: utf-8 -*-
</span><span class="python1-documentation">&quot;&quot;&quot;Ejercicio18

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1hKGxOw_-rs49P3dLY6EOlN8HtQElfmW4
&quot;&quot;&quot;

</span><span class="python1-comment"># рџ“љ LibrerГ­as
</span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">pandas</span><span class="python1-space"> </span><span class="python1-reservedword">as</span><span class="python1-space"> </span><span class="python1-identifier">pd
</span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">numpy</span><span class="python1-space"> </span><span class="python1-reservedword">as</span><span class="python1-space"> </span><span class="python1-identifier">np
</span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">matplotlib</span><span class="python1-symbol">.</span><span class="python1-identifier">pyplot</span><span class="python1-space"> </span><span class="python1-reservedword">as</span><span class="python1-space"> </span><span class="python1-identifier">plt
</span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">seaborn</span><span class="python1-space"> </span><span class="python1-reservedword">as</span><span class="python1-space"> </span><span class="python1-identifier">sns
</span><span class="python1-reservedword">from</span><span class="python1-space"> </span><span class="python1-identifier">statsmodels</span><span class="python1-symbol">.</span><span class="python1-identifier">tsa</span><span class="python1-symbol">.</span><span class="python1-identifier">stattools</span><span class="python1-space"> </span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">adfuller</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">kpss
</span><span class="python1-reservedword">from</span><span class="python1-space"> </span><span class="python1-identifier">statsmodels</span><span class="python1-symbol">.</span><span class="python1-identifier">graphics</span><span class="python1-symbol">.</span><span class="python1-identifier">tsaplots</span><span class="python1-space"> </span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">plot_acf</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">plot_pacf
</span><span class="python1-reservedword">from</span><span class="python1-space"> </span><span class="python1-identifier">statsmodels</span><span class="python1-symbol">.</span><span class="python1-identifier">tsa</span><span class="python1-symbol">.</span><span class="python1-identifier">arima</span><span class="python1-symbol">.</span><span class="python1-identifier">model</span><span class="python1-space"> </span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">ARIMA
</span><span class="python1-reservedword">from</span><span class="python1-space"> </span><span class="python1-identifier">google</span><span class="python1-symbol">.</span><span class="python1-identifier">colab</span><span class="python1-space"> </span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">files

</span><span class="python1-comment"># рџ”ј Subir archivo .txt
</span><span class="python1-identifier">uploaded</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">files</span><span class="python1-symbol">.</span><span class="python1-identifier">upload</span><span class="python1-symbol">()
</span><span class="python1-identifier">filename</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">list</span><span class="python1-symbol">(</span><span class="python1-identifier">uploaded</span><span class="python1-symbol">.</span><span class="python1-identifier">keys</span><span class="python1-symbol">())[</span><span class="python1-number">0</span><span class="python1-symbol">]

</span><span class="python1-comment"># рџ§№ Leer datos del archivo
</span><span class="python1-reservedword">with</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">open</span><span class="python1-symbol">(</span><span class="python1-identifier">filename</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">&quot;r&quot;</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-reservedword">as</span><span class="python1-space"> </span><span class="python1-identifier">f</span><span class="python1-symbol">:
</span><span class="python1-space">    </span><span class="python1-identifier">lines</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">f</span><span class="python1-symbol">.</span><span class="python1-identifier">readlines</span><span class="python1-symbol">()

</span><span class="python1-identifier">data_lines</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">lines</span><span class="python1-symbol">[</span><span class="python1-number">10</span><span class="python1-symbol">:]
</span><span class="python1-identifier">data_cleaned</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-identifier">line</span><span class="python1-symbol">.</span><span class="python1-identifier">strip</span><span class="python1-symbol">().</span><span class="python1-identifier">split</span><span class="python1-symbol">()</span><span class="python1-space"> </span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">line</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-identifier">data_lines</span><span class="python1-space"> </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">len</span><span class="python1-symbol">(</span><span class="python1-identifier">line</span><span class="python1-symbol">.</span><span class="python1-identifier">strip</span><span class="python1-symbol">().</span><span class="python1-identifier">split</span><span class="python1-symbol">())</span><span class="python1-space"> </span><span class="python1-symbol">==</span><span class="python1-space"> </span><span class="python1-number">6</span><span class="python1-symbol">]
</span><span class="python1-identifier">columns</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-string">&quot;YEAR&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">&quot;GDP&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">&quot;PDI&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">&quot;PCE&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">&quot;PROFITS&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">&quot;DIVIDENDS&quot;</span><span class="python1-symbol">]
</span><span class="python1-identifier">df</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">pd</span><span class="python1-symbol">.</span><span class="python1-identifier">DataFrame</span><span class="python1-symbol">(</span><span class="python1-identifier">data_cleaned</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">columns</span><span class="python1-symbol">=</span><span class="python1-identifier">columns</span><span class="python1-symbol">).</span><span class="python1-identifier">astype</span><span class="python1-symbol">(</span><span class="python1-nonreservedkeyword">float</span><span class="python1-symbol">)

</span><span class="python1-comment"># рџ•“ ГЌndice temporal trimestral
</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;DATE&quot;</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">pd</span><span class="python1-symbol">.</span><span class="python1-identifier">date_range</span><span class="python1-symbol">(</span><span class="python1-identifier">start</span><span class="python1-symbol">=</span><span class="python1-string">&quot;1970-01-01&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">periods</span><span class="python1-symbol">=</span><span class="python1-nonreservedkeyword">len</span><span class="python1-symbol">(</span><span class="python1-identifier">df</span><span class="python1-symbol">),</span><span class="python1-space"> </span><span class="python1-identifier">freq</span><span class="python1-symbol">=</span><span class="python1-string">'Q'</span><span class="python1-symbol">)
</span><span class="python1-identifier">df</span><span class="python1-symbol">.</span><span class="python1-identifier">set_index</span><span class="python1-symbol">(</span><span class="python1-string">&quot;DATE&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">inplace</span><span class="python1-symbol">=</span><span class="python1-nonreservedkeyword">True</span><span class="python1-symbol">)

</span><span class="python1-comment"># рџ”Ќ Logaritmo natural del PDI
</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;log_PDI&quot;</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">np</span><span class="python1-symbol">.</span><span class="python1-identifier">log</span><span class="python1-symbol">(</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;PDI&quot;</span><span class="python1-symbol">])

</span><span class="python1-comment"># рџ“Љ Graficar log(PDI)
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">figure</span><span class="python1-symbol">(</span><span class="python1-identifier">figsize</span><span class="python1-symbol">=(</span><span class="python1-number">10</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">4</span><span class="python1-symbol">))
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">plot</span><span class="python1-symbol">(</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;log_PDI&quot;</span><span class="python1-symbol">])
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">title</span><span class="python1-symbol">(</span><span class="python1-string">&quot;Serie Log(PDI)&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">grid</span><span class="python1-symbol">(</span><span class="python1-nonreservedkeyword">True</span><span class="python1-symbol">)
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">show</span><span class="python1-symbol">()

</span><span class="python1-comment"># рџ“€ Pruebas de estacionariedad
</span><span class="python1-reservedword">def</span><span class="python1-space"> </span><span class="python1-functionname">test_stationarity</span><span class="python1-symbol">(</span><span class="python1-identifier">series</span><span class="python1-symbol">):
</span><span class="python1-space">    </span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-string">&quot;рџ“‰ ADF Test:&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">    </span><span class="python1-identifier">adf</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">adfuller</span><span class="python1-symbol">(</span><span class="python1-identifier">series</span><span class="python1-symbol">)
</span><span class="python1-space">    </span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-identifier">f</span><span class="python1-string">&quot;ADF p-value: {adf[1]:.4f} {'(Estacionaria)' if adf[1] &lt; 0.05 else '(No estacionaria)'}&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">    </span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-string">&quot;\nрџ“‰ KPSS Test:&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">    </span><span class="python1-identifier">kpss_stat</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">kpss</span><span class="python1-symbol">(</span><span class="python1-identifier">series</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">regression</span><span class="python1-symbol">=</span><span class="python1-string">'c'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">nlags</span><span class="python1-symbol">=</span><span class="python1-string">&quot;auto&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">    </span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-identifier">f</span><span class="python1-string">&quot;KPSS p-value: {kpss_stat[1]:.4f} {'(Estacionaria)' if kpss_stat[1] &gt;= 0.05 else '(No estacionaria)'}&quot;</span><span class="python1-symbol">)

</span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-string">&quot;рџ”Ќ Pruebas para log(PDI)&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">test_stationarity</span><span class="python1-symbol">(</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;log_PDI&quot;</span><span class="python1-symbol">])

</span><span class="python1-comment"># вљ™пёЏ Primera diferencia
</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;log_PDI_diff&quot;</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;log_PDI&quot;</span><span class="python1-symbol">].</span><span class="python1-identifier">diff</span><span class="python1-symbol">()

</span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-string">&quot;\nрџ”Ќ Pruebas para О”log(PDI)&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">test_stationarity</span><span class="python1-symbol">(</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;log_PDI_diff&quot;</span><span class="python1-symbol">].</span><span class="python1-identifier">dropna</span><span class="python1-symbol">())

</span><span class="python1-comment"># рџ“‰ Graficar ACF y PACF
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">figure</span><span class="python1-symbol">(</span><span class="python1-identifier">figsize</span><span class="python1-symbol">=(</span><span class="python1-number">14</span><span class="python1-symbol">,</span><span class="python1-number">5</span><span class="python1-symbol">))
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">subplot</span><span class="python1-symbol">(</span><span class="python1-number">1</span><span class="python1-symbol">,</span><span class="python1-number">2</span><span class="python1-symbol">,</span><span class="python1-number">1</span><span class="python1-symbol">)
</span><span class="python1-identifier">plot_acf</span><span class="python1-symbol">(</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;log_PDI_diff&quot;</span><span class="python1-symbol">].</span><span class="python1-identifier">dropna</span><span class="python1-symbol">(),</span><span class="python1-space"> </span><span class="python1-identifier">ax</span><span class="python1-symbol">=</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">gca</span><span class="python1-symbol">(),</span><span class="python1-space"> </span><span class="python1-identifier">lags</span><span class="python1-symbol">=</span><span class="python1-number">20</span><span class="python1-symbol">)
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">title</span><span class="python1-symbol">(</span><span class="python1-string">&quot;ACF О”log(PDI)&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">subplot</span><span class="python1-symbol">(</span><span class="python1-number">1</span><span class="python1-symbol">,</span><span class="python1-number">2</span><span class="python1-symbol">,</span><span class="python1-number">2</span><span class="python1-symbol">)
</span><span class="python1-identifier">plot_pacf</span><span class="python1-symbol">(</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;log_PDI_diff&quot;</span><span class="python1-symbol">].</span><span class="python1-identifier">dropna</span><span class="python1-symbol">(),</span><span class="python1-space"> </span><span class="python1-identifier">ax</span><span class="python1-symbol">=</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">gca</span><span class="python1-symbol">(),</span><span class="python1-space"> </span><span class="python1-identifier">lags</span><span class="python1-symbol">=</span><span class="python1-number">20</span><span class="python1-symbol">)
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">title</span><span class="python1-symbol">(</span><span class="python1-string">&quot;PACF О”log(PDI)&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">tight_layout</span><span class="python1-symbol">()
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">show</span><span class="python1-symbol">()

</span><span class="python1-comment"># рџ§Є Ajustar modelos AR, MA, ARMA, ARIMA
</span><span class="python1-reservedword">from</span><span class="python1-space"> </span><span class="python1-identifier">statsmodels</span><span class="python1-symbol">.</span><span class="python1-identifier">tsa</span><span class="python1-symbol">.</span><span class="python1-identifier">arima</span><span class="python1-symbol">.</span><span class="python1-identifier">model</span><span class="python1-space"> </span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">ARIMA

</span><span class="python1-reservedword">def</span><span class="python1-space"> </span><span class="python1-functionname">fit_model</span><span class="python1-symbol">(</span><span class="python1-identifier">order</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">name</span><span class="python1-symbol">):
</span><span class="python1-space">    </span><span class="python1-reservedword">try</span><span class="python1-symbol">:
</span><span class="python1-space">        </span><span class="python1-identifier">model</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">ARIMA</span><span class="python1-symbol">(</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;log_PDI&quot;</span><span class="python1-symbol">],</span><span class="python1-space"> </span><span class="python1-identifier">order</span><span class="python1-symbol">=</span><span class="python1-identifier">order</span><span class="python1-symbol">).</span><span class="python1-identifier">fit</span><span class="python1-symbol">()
</span><span class="python1-space">        </span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-identifier">f</span><span class="python1-string">&quot;{name} {order} - AIC: {model.aic:.2f}&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        </span><span class="python1-reservedword">return</span><span class="python1-space"> </span><span class="python1-identifier">model
</span><span class="python1-space">    </span><span class="python1-reservedword">except</span><span class="python1-symbol">:
</span><span class="python1-space">        </span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-identifier">f</span><span class="python1-string">&quot;{name} {order} - FallГі&quot;</span><span class="python1-symbol">)
</span><span class="python1-space">        </span><span class="python1-reservedword">return</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">None

</span><span class="python1-comment"># Modelos candidatos
</span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-string">&quot;\nрџ“Њ Modelos AR(p)&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">ar_models</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-identifier">fit_model</span><span class="python1-symbol">((</span><span class="python1-identifier">p</span><span class="python1-symbol">,</span><span class="python1-number">1</span><span class="python1-symbol">,</span><span class="python1-number">0</span><span class="python1-symbol">),</span><span class="python1-space"> </span><span class="python1-identifier">f</span><span class="python1-string">&quot;AR({p})&quot;</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">p</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">range</span><span class="python1-symbol">(</span><span class="python1-number">1</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">4</span><span class="python1-symbol">)]

</span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-string">&quot;\nрџ“Њ Modelos MA(q)&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">ma_models</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-identifier">fit_model</span><span class="python1-symbol">((</span><span class="python1-number">0</span><span class="python1-symbol">,</span><span class="python1-number">1</span><span class="python1-symbol">,</span><span class="python1-identifier">q</span><span class="python1-symbol">),</span><span class="python1-space"> </span><span class="python1-identifier">f</span><span class="python1-string">&quot;MA({q})&quot;</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">q</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">range</span><span class="python1-symbol">(</span><span class="python1-number">1</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">4</span><span class="python1-symbol">)]

</span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-string">&quot;\nрџ“Њ Modelos ARMA(p,q)&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">arma_models</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-identifier">fit_model</span><span class="python1-symbol">((</span><span class="python1-identifier">p</span><span class="python1-symbol">,</span><span class="python1-number">1</span><span class="python1-symbol">,</span><span class="python1-identifier">q</span><span class="python1-symbol">),</span><span class="python1-space"> </span><span class="python1-identifier">f</span><span class="python1-string">&quot;ARMA({p},{q})&quot;</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">p</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">range</span><span class="python1-symbol">(</span><span class="python1-number">1</span><span class="python1-symbol">,</span><span class="python1-number">3</span><span class="python1-symbol">)</span><span class="python1-space"> </span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">q</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">range</span><span class="python1-symbol">(</span><span class="python1-number">1</span><span class="python1-symbol">,</span><span class="python1-number">3</span><span class="python1-symbol">)]

</span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-string">&quot;\nрџ“Њ Mejor modelo ARIMA(p,d,q)&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">best_aic</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">np</span><span class="python1-symbol">.</span><span class="python1-identifier">inf
best_model</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">None
</span><span class="python1-identifier">best_order</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">None

</span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">p</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">range</span><span class="python1-symbol">(</span><span class="python1-number">4</span><span class="python1-symbol">):
</span><span class="python1-space">    </span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">q</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-nonreservedkeyword">range</span><span class="python1-symbol">(</span><span class="python1-number">4</span><span class="python1-symbol">):
</span><span class="python1-space">        </span><span class="python1-reservedword">try</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-identifier">model</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">ARIMA</span><span class="python1-symbol">(</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;log_PDI&quot;</span><span class="python1-symbol">],</span><span class="python1-space"> </span><span class="python1-identifier">order</span><span class="python1-symbol">=(</span><span class="python1-identifier">p</span><span class="python1-symbol">,</span><span class="python1-number">1</span><span class="python1-symbol">,</span><span class="python1-identifier">q</span><span class="python1-symbol">)).</span><span class="python1-identifier">fit</span><span class="python1-symbol">()
</span><span class="python1-space">            </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">model</span><span class="python1-symbol">.</span><span class="python1-identifier">aic</span><span class="python1-space"> </span><span class="python1-symbol">&lt;</span><span class="python1-space"> </span><span class="python1-identifier">best_aic</span><span class="python1-symbol">:
</span><span class="python1-space">                </span><span class="python1-identifier">best_aic</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">model</span><span class="python1-symbol">.</span><span class="python1-identifier">aic
</span><span class="python1-space">                </span><span class="python1-identifier">best_model</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">model
</span><span class="python1-space">                </span><span class="python1-identifier">best_order</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">(</span><span class="python1-identifier">p</span><span class="python1-symbol">,</span><span class="python1-number">1</span><span class="python1-symbol">,</span><span class="python1-identifier">q</span><span class="python1-symbol">)
</span><span class="python1-space">        </span><span class="python1-reservedword">except</span><span class="python1-symbol">:
</span><span class="python1-space">            </span><span class="python1-reservedword">continue

print</span><span class="python1-symbol">(</span><span class="python1-identifier">f</span><span class="python1-string">&quot;рџЏ† Mejor ARIMA: {best_order} con AIC={best_aic:.2f}&quot;</span><span class="python1-symbol">)

</span><span class="python1-comment"># рџ“€ PronГіstico
</span><span class="python1-identifier">forecast_steps</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-number">8
</span><span class="python1-identifier">forecast</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">best_model</span><span class="python1-symbol">.</span><span class="python1-identifier">get_forecast</span><span class="python1-symbol">(</span><span class="python1-identifier">steps</span><span class="python1-symbol">=</span><span class="python1-identifier">forecast_steps</span><span class="python1-symbol">)
</span><span class="python1-identifier">pred</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">forecast</span><span class="python1-symbol">.</span><span class="python1-identifier">predicted_mean
ci</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">forecast</span><span class="python1-symbol">.</span><span class="python1-identifier">conf_int</span><span class="python1-symbol">()

</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">figure</span><span class="python1-symbol">(</span><span class="python1-identifier">figsize</span><span class="python1-symbol">=(</span><span class="python1-number">10</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">4</span><span class="python1-symbol">))
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">plot</span><span class="python1-symbol">(</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">&quot;log_PDI&quot;</span><span class="python1-symbol">],</span><span class="python1-space"> </span><span class="python1-identifier">label</span><span class="python1-symbol">=</span><span class="python1-string">&quot;HistГіrico&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">plot</span><span class="python1-symbol">(</span><span class="python1-identifier">pred</span><span class="python1-symbol">.</span><span class="python1-identifier">index</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">pred</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">label</span><span class="python1-symbol">=</span><span class="python1-string">&quot;PronГіstico&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">color</span><span class="python1-symbol">=</span><span class="python1-string">&quot;red&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">fill_between</span><span class="python1-symbol">(</span><span class="python1-identifier">pred</span><span class="python1-symbol">.</span><span class="python1-identifier">index</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">ci</span><span class="python1-symbol">.</span><span class="python1-identifier">iloc</span><span class="python1-symbol">[:,</span><span class="python1-number">0</span><span class="python1-symbol">],</span><span class="python1-space"> </span><span class="python1-identifier">ci</span><span class="python1-symbol">.</span><span class="python1-identifier">iloc</span><span class="python1-symbol">[:,</span><span class="python1-number">1</span><span class="python1-symbol">],</span><span class="python1-space"> </span><span class="python1-identifier">color</span><span class="python1-symbol">=</span><span class="python1-string">&quot;pink&quot;</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">alpha</span><span class="python1-symbol">=</span><span class="python1-float">0.3</span><span class="python1-symbol">)
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">title</span><span class="python1-symbol">(</span><span class="python1-identifier">f</span><span class="python1-string">&quot;PronГіstico ARIMA{best_order}&quot;</span><span class="python1-symbol">)
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">legend</span><span class="python1-symbol">()
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">grid</span><span class="python1-symbol">(</span><span class="python1-nonreservedkeyword">True</span><span class="python1-symbol">)
</span><span class="python1-identifier">plt</span><span class="python1-symbol">.</span><span class="python1-identifier">show</span><span class="python1-symbol">()
</span></code></pre><!--EndFragment--></body>
</html>